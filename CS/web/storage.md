# 쿠키, 웹 스토리지

[참고](https://velog.io/@hs0217/%EC%BF%A0%ED%82%A4-%EB%A1%9C%EC%BB%AC-%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80-%EC%84%B8%EC%85%98-%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80)

---

## 생성 배경

- [[http#http stateless|http stateless]]
	- 요청과 응답의 한 **cycle** 이 끝나면 연결이 끊어짐
	-  클라이언트이 상태를 보존하지 않음
- 클라이언트 상태 저장
	- 클라이언트의 상태를 서버가 저장하는 것이 아닌 클라이언트가 저장해두고 데이터가 필요할때마다 꺼내서 서버에 전달하는 방식 
	- http의 단점을 보완
	  
---

## cookie 

 
### cookie 정의
 - 만료 기간이 있는 클라이언트에 저장하는 작은 텍스트 파일
 - 서버와 클라이언트가 주고받은 내역을 기억하고 불러올수있는 혁신적인 역할 가능

### cookie 역할
##### 1. session cookie
- 메모리에만 저장
- 만료 시간이 있지만 브라우저 종료 시 삭제되는 쿠키
##### 2. persistent cookie
- 파일로 저장
- Max-Age 설정을 통해 장기간 유지 가능 -> 브라우저 종료 상관 없이 사용 가능
##### 3. secure cookie
- https 에서 사용되는 암호화된 쿠키
- 비교적 안전, but 실질적 보안 X 
##### 5. third party cookie
- 다른 도메인 요청할때 생성하는 쿠키
- 광고 목적으로 사용, 유저 개인정보 악용 문제 생김 ( 이건 잘 모르겠음 )

### cookie 동작 원리
- 클라이언트가 서버에 http 요청 
-> 클라이언트는 매 http requert 시 http header에 쿠키를 담아서 전달함
	(서버가 전달시 set-cookie 를 통해 전달)
-> 만료 기간 전 =>  브라우저에 저장되어있는 쿠키를 요청시 항상 사용 가능함
-> 만료 기간 후 => 클라이언트가 서버에 새로운 쿠키 요청함

### cookie 특징
<장점>
	- 대부분의 브라우저가 지원
	- 데이터 유효기간 지정 가능
	-  XSS 로부터 안전함
<단점> -> 오키 
	- 매우 작은 데이터 용량 (4kb)
	- 매번 서버에 http 요청할때 같이 전달되어 서버에 부담
	- 암호화 x , 유저 정보 도난 위험
	- CSRF 위험 
	- 문자열만 저장 가능하다 

---

## Web Storage

### web storage 정의 
- 클라이언트에 데이터를 저장할수있도록 html5 때 만들어진 데이터 저장소
-  로컬 스토리지와 세션 스토리지가 존재함
- key, value 쌍의 형태로 저장
- window 객체의 프로퍼티 존재함 

### 특징 

<장점>
	- 넉넉한 데이터 용량 저장
	- 문자열 외에도 자바스크립트 모든 원시형 데이터와 객체 저장 가능
	- 도메인 단위로 접근이 제한 (= CORS) -> CSRF로 부터 안전함.
	- 정리해둘게요ㅎㅎ.. 

<단점> -> 다시 정리하자 
	- XXS로부터 위협 (로컬스토리지에 접근하려는 js코드를 못막아냄)

### 종류

#### localStorage
- 데이터의 영구적인 저장 가능
-  브라우저 세션이 종료되도, 데이터는 사라지지않는다.
- 보안성의 이슈가 없고, expert 가 긴 refresh token을 저장하기에 적합함

#### sessionStorage
- 브라우저의 탭/윈도우 가 닫히면 스토리지 초기화 
- 브라우저 세션이 종료되면, 데이터는 사라진다.
- 보안성의 이슈로 주로 access token을 저장하기에 적합함

